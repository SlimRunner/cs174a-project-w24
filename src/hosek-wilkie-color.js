/*
This is again the same Wilkie-Hosek model from Shadertoy
https://www.shadertoy.com/view/wslfD7

However, the implementation here is for JavaScript, and its purpose is
to get an "averaged sky color" that I can use to dynamically change the
ambient color of the scene along with lighting color and intensity.
*/

const ALBEDO = 1;
const TURBIDITY = 3;

const M_PI = Math.PI;
const CIE_X = 0;
const CIE_Y = 1;
const CIE_Z = 2;

const kHosekCoeffsX = [
  -1.171419, -0.242975, -8.991334, 9.571216, -0.027729, 0.668826, 0.076835,
  3.785611, 0.634764, -1.228554, -0.291756, 2.753986, -2.49178, -0.046634,
  0.31183, 0.075465, 4.463096, 0.595507, -1.093124, -0.244777, 0.909741,
  0.54483, -0.295782, 2.024167, -0.000515, -1.069081, 0.936956, -1.056994,
  0.015695, -0.821749, 1.870818, 0.706193, -1.483928, 0.597821, 6.864902,
  0.367333, -1.054871, -0.275813, 2.712807, -5.95011, -6.554039, 2.447523,
  -0.189517, -1.454292, 0.913174, -1.100218, -0.174624, 1.438505, 11.15481,
  -3.266076, -0.883736, 0.19701, 1.991595, 0.590782,
];

const kHosekCoeffsY = [
  -1.185983, -0.258118, -7.761056, 8.317053, -0.033518, 0.667667, 0.059417,
  3.820727, 0.632403, -1.268591, -0.339807, 2.348503, -2.023779, -0.053685,
  0.108328, 0.084029, 3.910254, 0.557748, -1.071353, -0.199246, 0.787839,
  0.19747, -0.303306, 2.335298, -0.082053, 0.795445, 0.997231, -1.089513,
  -0.031044, -0.599575, 2.330281, 0.658194, -1.821467, 0.667997, 5.090195,
  0.312516, -1.040214, -0.257093, 2.660489, -6.506045, -7.053586, 2.763153,
  -0.243363, -0.764818, 0.945294, -1.116052, -0.183199, 1.457694, 11.63608,
  -3.216426, -1.045594, 0.2285, 1.817407, 0.58104,
];

const kHosekCoeffsZ = [
  -1.354183, -0.513062, -42.19268, 42.71772, -0.005365, 0.413674, 0.012352,
  2.520122, 0.518727, -1.741434, -0.958976, -8.230339, 9.296799, -0.0096,
  0.499497, 0.029555, 0.36671, 0.3527, -0.691735, 0.215489, -0.876026, 0.233412,
  -0.019096, 0.474803, -0.113851, 6.51536, 1.225097, -1.293189, -0.42187,
  1.620952, -0.78586, -0.037694, 0.663679, 0.336494, -0.534102, 0.212835,
  -0.973552, -0.132549, 1.007517, 0.259826, 0.067622, 0.001421, -0.06916,
  3.185897, 0.864196, -1.0948, -0.196206, 0.575559, 0.290626, 0.262575,
  0.764405, 0.134749, 2.677126, 0.646546,
];

const kHosekRadX = [1.468395, 2.21197, -2.845869, 20.75027, 15.24822, 19.37622];

const kHosekRadY = [
  1.516536, 2.438729, -3.624121, 22.98621, 15.99782, 20.70027,
];

const kHosekRadZ = [1.234428, 2.289628, -3.404699, 14.99436, 34.6839, 30.84842];


